#!/bin/bash
code=$(cat <<EOF
GUI {
Horizontally@bottom?"bot":"top" {
    prompt=Label(label=pstring,highlight=1);
    input=Input(minwidth=200);
    list=HList();
  }
}
option pstring (-p,--prompt,"Set the input prompt", "STRING", "")
option bottom (-b,,"Appear at bottom of screen")
stdin->lines(lines) { list.insert(lines) }
BEGIN { focus input }
<C-g> { exit 1 }
<Up> || <C-p> { list.prev() }
<Down> || <C-n> { list.next() }
<Return> { print list.selected || input.value; exit }
<Shift-Return> { print input.value; exit }
<C-i> || <Tab> { if (list.selected) { input.value = list.selected } }
input.value->changed(from, to) { list.filter(to) }
EOF
)
exec -a dmenu sindre -e "$code" "$@"
